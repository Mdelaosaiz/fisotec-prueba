<!doctype html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" type="text/css">
  <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" type="text/javascript"></script>
  <script src="https://unpkg.com/esri-leaflet@2.1.4/dist/esri-leaflet.js"></script>
  <script src="./js/leaflet.ajax.min.js" type="text/javascript"></script>
  <style>
    html, body {
      height: 100%;
      width: 100%;
      margin: 0
    }
    #mapa {
      height: 100%;
      width: 100%;
    }
  </style>
  <title>Prueba FISOTEC</title>
</head>

<body>
  <div id="mapa"></div>

  <script type="text/javascript">
    var mapa = L.map("mapa", {
      center: [0, 0],
      zoom: 2
    });

    var capaOrtoFoto = L.esri.basemapLayer("Imagery");
    capaOrtoFoto.addTo(mapa);

    var url = "https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.geojson";

    L.Util.ajax(url).then(
      function (datosGeoJOSN) {
        var capaTerremotos = L.geoJSON(datosGeoJOSN, {
          pointToLayer: function (entidad, latlng) {
            return L.circleMarker(latlng);
          },
          style: function (entidad) {
            var magnitud = entidad.properties.mag;
            var colorTerremoto;
            if (magnitud > 6) {
              colorTerremoto = "rgba(255, 0, 0)"
            } else if (magnitud <= 6 && magnitud > 5) {
              colorTerremoto = "rgba(255, 255, 0)"
            } else if (magnitud <= 5 && magnitud > 4) {
              colorTerremoto = "rgba(0, 255, 255)"
            } else {
              colorTerremoto = "rgba(0, 0, 255)"
            }

            var miEstilo = {
              radius: 1.6 ** magnitud,
              fillColor: colorTerremoto,
              fillOpacity: 0.4,
              color: "rgba(0, 0, 0, 0.7)",
              weight: 1
            };

            return miEstilo
          }
        });
        
        capaTerremotos.bindPopup(function (entidad) {
            return 'Magnitud: ' + entidad.feature.properties.mag
        });

        capaTerremotos.addTo(mapa);
      });
  </script>
</body>

</html>